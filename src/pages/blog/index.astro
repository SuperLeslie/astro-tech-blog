---
import Layout from '../../layouts/Layout.astro';
import BlogCard from '../../components/BlogCard.astro';
import '../../styles/global.css';
import { WordPressCache, type CachedPost } from '../../utils/wordpress-cache';

// ä½¿ç”¨ç¼“å­˜è·å–æ–‡ç« æ•°æ®ï¼Œæå‡æ€§èƒ½
const posts: CachedPost[] = await WordPressCache.getPostsList();
---

<Layout>
  <main class="min-h-screen bg-gray-50">
    <!-- Header Navigation -->
    <header class="bg-white shadow-sm border-b">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-4">
          <div class="flex items-center">
            <a href="/" class="text-2xl font-bold text-gray-900 hover:text-indigo-600 transition-colors">
              TechBlog
            </a>
          </div>
          <nav class="hidden md:flex space-x-8">
            <a href="/" class="text-gray-600 hover:text-indigo-600 transition-colors font-medium">é¦–é¡µ</a>
            <a href="/blog" class="text-indigo-600 font-medium">åšå®¢</a>
            <a href="#" class="text-gray-600 hover:text-indigo-600 transition-colors font-medium">åˆ†ç±»</a>
            <a href="#" class="text-gray-600 hover:text-indigo-600 transition-colors font-medium">å…³äº</a>
            <a href="#" class="text-gray-600 hover:text-indigo-600 transition-colors font-medium">è”ç³»</a>
          </nav>
          <div class="flex items-center space-x-4">
            <button class="text-gray-600 hover:text-indigo-600 transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </button>
            <button class="md:hidden text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Hero Section -->
    <section class="bg-linear-to-br from-indigo-900 via-indigo-800 to-purple-800 text-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <div class="text-center">
          <h1 class="text-3xl md:text-4xl font-bold mb-4">
            å¤–è´¸wordpresså»ºç«™åˆ†äº«å’Œå¿ƒå¾—
          </h1>
          <p class="text-lg md:text-xl text-indigo-200 mb-6 max-w-2xl mx-auto">
            æ¢ç´¢å‰ç«¯æŠ€æœ¯ã€åç«¯æ¶æ„ã€å¼€å‘å·¥å…·å’Œç¼–ç¨‹æœ€ä½³å®è·µ
          </p>
          <div class="flex flex-wrap justify-center gap-3 text-sm">
            <span class="bg-white/20 px-3 py-1 rounded-full">ğŸš€ å‰ç«¯å¼€å‘</span>
            <span class="bg-white/20 px-3 py-1 rounded-full">âš¡ å…¨æ ˆæŠ€æœ¯</span>
            <span class="bg-white/20 px-3 py-1 rounded-full">ğŸ› ï¸ å¼€å‘å·¥å…·</span>
            <span class="bg-white/20 px-3 py-1 rounded-full">ğŸ’¡ æœ€ä½³å®è·µ</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Navigation Breadcrumb -->
    <section class="bg-white border-b">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
        <nav class="flex items-center space-x-2 text-sm">
          <a href="/" class="text-gray-600 hover:text-indigo-600 transition-colors">
            é¦–é¡µ
          </a>
          <span class="text-gray-400">/</span>
          <span class="text-gray-900 font-medium">åšå®¢</span>
        </nav>
      </div>
    </section>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div class="lg:grid lg:grid-cols-12 lg:gap-12">
        <!-- Main Content -->
        <div class="lg:col-span-8">
          <!-- Featured Post -->
          {posts.length > 0 && (
            <section class="mb-12">
              <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                <span class="bg-indigo-600 text-white px-3 py-1 rounded-md text-sm font-medium mr-3">
                  ç‰¹è‰²æ–‡ç« 
                </span>
                <span class="h-px flex-1 bg-gray-200"></span>
              </h2>
              <div class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
                {posts[0]._embedded?.['wp:featuredmedia']?.[0]?.source_url && (
                  <div class="h-64 md:h-80 overflow-hidden">
                    <img 
                      src={posts[0]._embedded?.['wp:featuredmedia']?.[0]?.source_url} 
                      alt={posts[0].title.rendered}
                      class="w-full h-full object-cover hover:scale-105 transition-transform duration-500"
                    />
                  </div>
                )}
                <div class="p-8">
                  <div class="flex items-center mb-4">
                    <span class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium">
                      æœ€æ–°å‘å¸ƒ
                    </span>
                    <span class="text-gray-500 text-sm ml-4">
                      {new Date(posts[0].date).toLocaleDateString('zh-CN')}
                    </span>
                  </div>
                  <h3 class="text-2xl md:text-3xl font-bold text-gray-900 mb-4 leading-tight" set:html={posts[0].title.rendered}></h3>
                  <p class="text-gray-600 text-lg leading-relaxed mb-6" set:html={posts[0].excerpt.rendered.replace(/<[^>]*>/g, '').slice(0, 200) + '...'}></p>
                  <a 
                    href={`/blog/${decodeURIComponent(posts[0].slug)}`}
                    class="inline-flex items-center text-indigo-600 font-semibold hover:text-indigo-800 transition-colors"
                  >
                    ç»§ç»­é˜…è¯»
                    <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                    </svg>
                  </a>
                </div>
              </div>
            </section>
          )}

          <!-- Recent Posts Grid -->
          <section class="mb-12">
            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
              <span class="bg-gray-800 text-white px-3 py-1 rounded-md text-sm font-medium mr-3">
                æœ€æ–°æ–‡ç« 
              </span>
              <span class="h-px flex-1 bg-gray-200"></span>
            </h2>
            
            {posts.length > 1 ? (
              <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                {posts.slice(1).map((post) => (
                  <BlogCard
                    id={post.id}
                    slug={post.slug}
                    title={post.title.rendered}
                    excerpt={post.excerpt.rendered}
                    date={post.date}
                    featuredImage={post._embedded?.['wp:featuredmedia']?.[0]?.source_url}
                  />
                ))}
              </div>
            ) : (
              <div class="text-center py-12 bg-white rounded-xl">
                <p class="text-gray-500 text-lg">æš‚æ— æ›´å¤šæ–‡ç« </p>
              </div>
            )}
          </section>
        </div>

        <!-- Sidebar -->
        <aside class="lg:col-span-4">
          <!-- About Widget -->
          <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
            <h3 class="text-xl font-bold text-gray-900 mb-4">å…³äºåšå®¢</h3>
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 bg-linear-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg">
                æŠ€
              </div>
              <div class="ml-4">
                <h4 class="font-semibold text-gray-900">æŠ€æœ¯åˆ†äº«å¹³å°</h4>
                <p class="text-gray-600 text-sm">ä¸“æ³¨äºç°ä»£Webå¼€å‘</p>
              </div>
            </div>
            <p class="text-gray-600 text-sm leading-relaxed">
              åˆ†äº«å‰ç«¯æŠ€æœ¯ã€åç«¯å¼€å‘ã€DevOpså®è·µå’Œç¼–ç¨‹å¿ƒå¾—ã€‚è‡´åŠ›äºä¸ºå¼€å‘è€…æä¾›å®ç”¨çš„æŠ€æœ¯å†…å®¹å’Œæœ€ä½³å®è·µã€‚
            </p>
          </div>

          <!-- Stats Widget -->
          <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
            <h3 class="text-xl font-bold text-gray-900 mb-6">åšå®¢ç»Ÿè®¡</h3>
            <div class="grid grid-cols-2 gap-4">
              <div class="text-center p-4 bg-indigo-50 rounded-xl">
                <div class="text-2xl font-bold text-indigo-600">{posts.length}</div>
                <div class="text-sm text-gray-600">ç¯‡æ–‡ç« </div>
              </div>
              <div class="text-center p-4 bg-purple-50 rounded-xl">
                <div class="text-2xl font-bold text-purple-600">âˆ</div>
                <div class="text-sm text-gray-600">æ¬¡é˜…è¯»</div>
              </div>
            </div>
          </div>

          <!-- Popular Topics -->
          <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
            <h3 class="text-xl font-bold text-gray-900 mb-6">çƒ­é—¨è¯é¢˜</h3>
            <div class="flex flex-wrap gap-2">
              <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-blue-200 transition-colors cursor-pointer">
                React
              </span>
              <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-green-200 transition-colors cursor-pointer">
                Vue.js
              </span>
              <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-yellow-200 transition-colors cursor-pointer">
                JavaScript
              </span>
              <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-purple-200 transition-colors cursor-pointer">
                TypeScript
              </span>
              <span class="bg-pink-100 text-pink-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-pink-200 transition-colors cursor-pointer">
                CSS
              </span>
              <span class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-indigo-200 transition-colors cursor-pointer">
                Node.js
              </span>
              <span class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors cursor-pointer">
                DevOps
              </span>
            </div>
          </div>

          <!-- Newsletter Signup -->
          <div class="bg-linear-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-lg p-8 text-white">
            <h3 class="text-xl font-bold mb-4">è®¢é˜…æ›´æ–°</h3>
            <p class="text-indigo-100 text-sm mb-6">
              è·å–æœ€æ–°çš„æŠ€æœ¯æ–‡ç« å’Œå¼€å‘èµ„æºï¼Œç›´æ¥å‘é€åˆ°ä½ çš„é‚®ç®±ã€‚
            </p>
            <div class="space-y-4">
              <input 
                type="email" 
                placeholder="è¾“å…¥ä½ çš„é‚®ç®±åœ°å€"
                class="w-full px-4 py-3 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-white/50"
              />
              <button class="w-full bg-white text-indigo-600 font-semibold py-3 px-4 rounded-lg hover:bg-gray-100 transition-colors">
                ç«‹å³è®¢é˜…
              </button>
            </div>
          </div>
        </aside>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white mt-20">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <h3 class="text-xl font-bold mb-4">æŠ€æœ¯åšå®¢</h3>
            <p class="text-gray-400 leading-relaxed">
              ä¸“æ³¨äºåˆ†äº«ç°ä»£Webå¼€å‘æŠ€æœ¯ï¼Œå¸®åŠ©å¼€å‘è€…æˆé•¿å’Œå­¦ä¹ ã€‚
            </p>
          </div>
          <div>
            <h4 class="font-semibold mb-4">å¿«é€Ÿé“¾æ¥</h4>
            <ul class="space-y-2 text-gray-400">
              <li><a href="/" class="hover:text-white transition-colors">é¦–é¡µ</a></li>
              <li><a href="/blog" class="hover:text-white transition-colors">åšå®¢</a></li>
              <li><a href="#" class="hover:text-white transition-colors">å…³äº</a></li>
              <li><a href="#" class="hover:text-white transition-colors">è”ç³»</a></li>
            </ul>
          </div>
          <div>
            <h4 class="font-semibold mb-4">æŠ€æœ¯æ ˆ</h4>
            <ul class="space-y-2 text-gray-400">
              <li>Frontend: React, Vue, Astro</li>
              <li>Backend: Node.js, Python</li>
              <li>Styling: Tailwind CSS</li>
              <li>CMS: WordPress API</li>
            </ul>
          </div>
        </div>
        <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
          <p>Â© 2026 æŠ€æœ¯åšå®¢. All rights reserved. Made with â¤ï¸ and Astro</p>
        </div>
      </div>
    </footer>
  </main>
</Layout>
